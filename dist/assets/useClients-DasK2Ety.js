import{c as C,r as f,s as c}from"./index-PA-U-bDe.js";/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const x=C("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B=C("Wallet",[["path",{d:"M21 12V7H5a2 2 0 0 1 0-4h14v4",key:"195gfw"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h16v-5",key:"195n9w"}],["path",{d:"M18 12a2 2 0 0 0 0 4h4v-4Z",key:"vllfpd"}]]),L=(d,m)=>{const[k,i]=f.useState([]),[v,p]=f.useState(!0),[M,o]=f.useState(null),h=async()=>{try{p(!0),o(null);const{data:t,error:r}=await c.from("clients").select("*").order("created_at",{ascending:!1});if(r)throw r;let e=c.from("transfers").select("client_id, transfer_type, status, amount, net_amount, commission_amount").eq("status","completed");d&&(e=e.gte("created_at",d)),m&&(e=e.lte("created_at",m+"T23:59:59.999Z"));const{data:n,error:l}=await e;if(l)throw l;const u=(t||[]).map(y=>{const g=(n||[]).filter(s=>s.client_id===y.id),w=g.filter(s=>s.transfer_type==="incoming").reduce((s,a)=>s+(a.net_amount||a.amount||0),0),_=g.filter(s=>s.transfer_type==="outgoing").reduce((s,a)=>s+(a.net_amount||0),0),E=g.filter(s=>s.transfer_type==="outgoing").reduce((s,a)=>s+(a.commission_amount||0),0),q=w-_-E;return{...y,totalReceived:w,totalSent:_,totalCommissions:E,currentBalance:q}});i(u)}catch(t){console.error("Error fetching clients:",t),o(t instanceof Error?t.message:"An error occurred while fetching clients")}finally{p(!1)}},T=async t=>{try{o(null);const{data:r,error:e}=await c.from("clients").insert(t).select().single();if(e)throw e;return i(n=>[r,...n]),{success:!0,data:r}}catch(r){const e=r instanceof Error?r.message:"Failed to add client";return o(e),console.error("Error adding client:",r),{success:!1,error:e}}},S=async(t,r)=>{try{o(null);const{data:e,error:n}=await c.from("clients").update(r).eq("id",t).select().single();if(n)throw n;return i(l=>l.map(u=>u.id===t?e:u)),{success:!0,data:e}}catch(e){const n=e instanceof Error?e.message:"Failed to update client";return o(n),console.error("Error updating client:",e),{success:!1,error:n}}},W=async t=>{try{o(null);const{error:r}=await c.from("clients").delete().eq("id",t);if(r)throw r;return i(e=>e.filter(n=>n.id!==t)),{success:!0}}catch(r){const e=r instanceof Error?r.message:"Failed to delete client";return o(e),console.error("Error deleting client:",r),{success:!1,error:e}}};return f.useEffect(()=>{h()},[d,m]),{clients:k,loading:v,error:M,addClient:T,updateClient:S,deleteClient:W,refetch:h}};export{x as T,B as W,L as u};
